### 拜占庭将军问题

在讨论一致性协议问题之前，先来了解一下拜占庭将军问题，一组拜占庭将军分别带领一支部队共同围困一座城市，为了简化问题，将各支军队的行动策略限定为两种：进攻或者撤退，如果部分军队进攻部分撤退就可能会造成灾难性的问题，这个就是原子性很像，要不全部发生，要不就不发生。

为**了解决这种问题，拜占庭的将军们就必须通过选票来达到一致性策略，既要不所有军队一起进攻或者所有军队一起离开**，但是因为这些将军是在城市的不同地方，**他们之间只能通过信使来相互联系，所以在投票的过程中每位将军只能将自己投票给进攻还是撤退的消息通过信使来通知其他将军，这样一来每位将军根据自己的投票和其他所有将军送来的信息就可以知道共同的投票结果从而决定行动策略。**

但是会遇到以下问题：

可能这些将军中出现了叛徒，不仅可能向比较糟糕的策略投票，还可以会选择性的投票，比如一共9位将军，站在上帝视角来看最好的策略是撤退，但是这个时候投票结果是4:4，叛徒就有可能把票投给进攻方，也会把票投给撤退方，这样的话在4名进攻将军来看是5票，撤退将军也是5票，他们就会发起进攻和撤退，从而导致军队之间的一致性被破坏。

还有种情况因为将军之间是通过信使来交换意见，不排除可能有叛徒将军自己伪造了信件来欺骗其他将军。

假设所有的将军都是忠诚的情况下，也不能排除信使被敌人截杀，甚至换成敌人的间谍等等，所以很难通过保证人员的可靠性以及通讯的可靠性来解决问题。

假设那些忠诚的将军任然坚称少数服从多数原则来决定它们的策略，就会达到被称为拜占庭容错状态，票都会有一个默认值，如果消息没被收到，就是用这个默认值来投票。

### 一致性协议

### Raft